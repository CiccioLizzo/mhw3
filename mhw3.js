 
 
const menuData = {
  "Store": {
    columns: [
      {
        heading: "Acquista",
        links: [
          { text: "Acquista i nuovi prodotti", url: "#" },
          { text: "Mac", url: "#" },
          { text: "iPad", url: "#" },
          { text: "iPhone", url: "#" },
          { text: "Apple Watch", url: "#" },
          { text: "Accessori", url: "#" }
        ]
      },
      {
        heading: "Link rapidi",
        links: [
          { text: "Trova uno store", url: "#" },
          { text: "Ricondizionati certificati", url: "#" },
          { text: "Apple Trade In", url: "#" },
          { text: "Finanziamenti", url: "#" },
          { text: "Business", url: "#" }
        ]
      },
      {
        heading: "Acquista sugli store dedicati",
        links: [
          { text: "Ricondizionati certificati", url: "#" },
          { text: "instruzione", url: "#" },
          { text: "Buisness", url: "#" }
        ]
      }
    ]
  },
  "Storenav": {
    columns: [
      {
        
        links: [
          { text: "Store", url: "#" },
          { text: "Mac", url: "#" },
          { text: "iPad", url: "#" },
          { text: "iPhone", url: "#" },
          { text: "Watch", url: "#" },
          { text: "AirPods", url: "#" },
          { text: "TV & Casa", url: "#" },
          { text: "Intrattenimento", url: "#" },
          { text: "Accessori", url: "#" },
          { text: "Supporto", url: "#" }
          
        ]
      },
      
    ]
  },
  "Mac": {
    columns: [
      {
        heading: "Mac",
        links: [
          {text: "Scopri la linea Mac",url: "#"},
          { text: "MacBook Air", url: "#" },
          { text: "MacBook Pro", url: "#" },
          { text: "iMac", url: "#" },
          { text: "Mac mini", url: "#" },
          { text: "Mac Studio", url: "#" },
          { text: "Mac Pro", url: "#" },
          { text: "Display", url: "#" }
        ]
      },
      {
        heading: "Acquista Mac",
        links: [
          { text: "Acquista Mac", url: "#" },
          { text: "Accessori Mac", url: "#" },
          { text: "Apple Trade In", url: "#" }
        ]
      },
      {
        heading: "Altro per mac",
        links: [
          { text: "Supporto Mac", url: "#" },
          { text: "AppleCare+ per Mac", url: "#" },
          { text: "MacOS Sequoia", url: "#" },
          { text: "Apple Intelligence", url: "#" },
          { text: "App made in Apple", url: "#" },
          { text: "Community", url: "#" },
          { text: "iCloud+", url: "#" },
          { text: "Mac al lavoro", url: "#" },
          { text: "Istruzione", url: "#" }
        ]
      }
    ]
  },
  "iPad": {
    columns: [
      {
        heading: "iPad",
        links: [
          { text: "Scopri la linea iPad", url: "#" },
          { text: "iPad Pro", url: "#" },
          { text: "iPad Air", url: "#" },
          { text: "iPad", url: "#" },
          { text: "iPad mini", url: "#" },
          { text: "Apple Pencil", url: "#" },
          { text: "Tastiere", url: "#" }
        ]
      },
      {
        heading: "Acquista iPad",
        links: [
          { text: "Acquista iPad", url: "#" },
          { text: "Accessori iPad", url: "#" },
          { text: "Apple Trade In", url: "#" }
        ]
      },
      {
        heading: "Altro per iPad",
        links: [
          { text: "Supporto iPad", url: "#" },
          { text: "AppleCare+ per iPad", url: "#" },
          { text: "iPadOS 18", url: "#" },
          { text: "Apple Intelligence", url: "#" },
          { text: "Per le famiglie", url: "#" },
          { text: "App made in Apple", url: "#" },
          { text: "iCloud+", url: "#" },
          { text: "Istruzione", url: "#" }
        ]
      }
    ]
  },
  "iPhone": {
    columns: [
      {
        heading: "iPhone",
        links: [
          { text: "Scopri la linea iPhone", url: "#" },
          { text: "iPhone 16 Pro", url: "#" },
          { text: "iPhone 16", url: "#" },
          { text: "iPhone 16e", url: "#" },
          { text: "iPhone 15", url: "#" }
        ]
      },
      {
        heading: "Acquista iPhone",
        links: [
          { text: "Acquista iPhone", url: "#" },
          { text: "Accessori iPhone", url: "#" },
          { text: "Apple Trade In", url: "#" },
          { text: "Finanziamenti", url: "#" }
        ]
      },
      {
        heading: "Altro per iPhone",
        links: [
          { text: "Supporto iPhone", url: "#" },
          { text: "AppleCare+ per iPhone", url: "#" },
          { text: "iOS 18", url: "#" },
          { text: "Apple Intelligence", url: "#" },
          { text: "Per le famiglie", url: "#" },
          { text: "App made in Apple", url: "#" },
          { text: "iPhone e la tua privacy", url: "#" },
          { text: "iCloud+", url: "#" },
          { text: "Apple Pay", url: "#" },
          { text: "Siri", url: "#" }
        ]
      }
    ]
  },
  "Watch": {
    columns: [
      {
        heading: "Apple Watch",
        links: [
          { text: "Scopri la linea Apple Watch", url: "#" },
          { text: "Apple Watch Series 10", url: "#" },
          { text: "Apple Watch Ultra 2", url: "#" },
          { text: "Apple Watch SE", url: "#" },
          { text: "Apple Watch Nike", url: "#" },
          { text: "Apple Watch Herm√®s", url: "#" }
          
          
        ]
      },
      {
        heading: "Acquista Apple Watch",
        links: [
          { text: "Acquista Apple Watch", url: "#" },
          { text: "Apple Watch Studio", url: "#" },
          { text: "Cinturini Apple Watch ", url: "#" },
          { text: "Accessori Apple Watch", url: "#" },
          { text: "Apple Trade In", url: "#" }
        ]
      },
      {
        heading: "Altro per Apple Watch",
        links: [
          { text: "Supporto Apple Watch", url: "#" },
          { text: "AppleCare+", url: "#" },
          { text: "watchOS 11", url: "#" },
          { text: "App made in Apple", url: "#" },
          { text: "Apple Fintness +", url: "#" }
          
        ]
      }
    ]
  },
  "AirPods": {
    columns: [
      {
        heading: "AirPods",
        links: [
          { text: "Scopri la linea AirPods", url: "#" },
          { text: "AirPods 4", url: "#" },
          { text: "AirPods Pro 2", url: "#" },
          { text: "AirPods Max", url: "#" }
        ]
      },
      {
        heading: "Acquista AirPods",
        links: [
          { text: "Acquista AirPods", url: "#" },
          { text: "Accessori AirPods", url: "#" }
          
        ]
      },
      {
        heading: "Altro per AirPods",
        links: [
          { text: "Supporto AirPods", url: "#" },
          { text: "AppleCare+ per le cuffie", url: "#" },
          { text: "Apple Music", url: "#" }
        ]
      }
    ]
  },
  "TV & Casa": {
    columns: [
      {
        heading: "TV & Casa",
        links: [
          { text: "Scopri la linea TV & Casa", url: "#" },
          { text: "Apple TV 4K", url: "#" },
          { text: "HomePod", url: "#" },
          { text: "HomePod mini", url: "#" }
        ]
      },
      {
        heading: "Acquista TV & Casa",
        links: [
          { text: "Acquista Apple TV 4K", url: "#" },
          { text: "Acquista HomePod", url: "#" },
          { text: "Acquista HomePod mini", url: "#" },
          { text: "Acquista Siri Remote", url: "#" },
          { text: "Accessori TV & Casa", url: "#" }
        ]
      },
      {
        heading: "Altro per TV & Casa",
        links: [
          { text: "Supporto TV & Casa", url: "#" },
          { text: "AppleCare+", url: "#" },
          { text: "App Apple TV", url: "#" },
          { text: "Apple TV +", url: "#" },
          { text: "App Casa", url: "#" },
          { text: "Apple Music", url: "#" },
          { text: "Siri", url: "#" },
          { text: "AirPlay", url: "#" }
          
        ]
      }
    ]
  },
  "Intrattenimento": {
    columns: [
      {
        heading: "Intrattenimento",
        links: [
          { text: "Scopri i servizi per l'intrattenimento", url: "#" },
          { text: "Apple One+", url: "#" },
          { text: "Apple TV+", url: "#" },
          { text: "Apple Music", url: "#" },
          { text: "Apple Arcade", url: "#" },
          { text: "Apple Fitness+", url: "#" },
          { text: "Apple Podcasts", url: "#" },
          { text: "Apple Books", url: "#" },
          { text: "App Store", url: "#" }
        ]
      },
      {
        heading: "Supporto",
        links: [
          { text: "Supporto Apple TV+", url: "#" },
          { text: "Supporto Applw Music", url: "#" }

        ]
      }
      
    ]
  },
  "Accessori": {
    columns: [
      {
        heading: "Accessori per",
        links: [
          { text: "Tutti gli accessori", url: "#" },
          { text: "Mac", url: "#" },
          { text: "iPad", url: "#" },
          { text: "iPhone", url: "#" },
          { text: "Apple Watch ", url: "#" },
          { text: "Air Pods", url: "#" },
          { text: "TV & Casa", url: "#" }
        ]
      },
      {
        heading: "Linee di Accessori",
        links: [
          { text: "Creati da Apple", url: "#" },
          { text: "Beats by Dr.Dre", url: "#" },
          { text: "AiTag", url: "#" }
        ]
      }
      
    ]
  },
  "Supporto": {
    columns: [
      {
        heading: "Supporto",
        links: [
          { text: "iPhone", url: "#" },
          { text: "Mac", url: "#" },
          { text: "iPad", url: "#" },
          { text: "Apple Watch", url: "#" },
          { text: "AirPods", url: "#" },
          { text: "Musica", url: "#" },
          { text: "TV", url: "#" }
        ]
      },
      {
        heading: "Ricevi assistenza",
        links: [
          { text: "Community", url: "#" },
          { text: "Verifica la copertura", url: "#" },
          { text: "Riparazioni", url: "#" }

        ]
      },
      {
        heading: "Argomenti utili",
        links: [
          { text: "Acquista AppleCare+", url: "#" },
          { text: "Apple account e password", url: "#" },
          { text: "Fatturazione e abbonamenti", url: "#" },
          { text: "Accessibilit√†", url: "#" }

        ]
      }
    ]
  }
  
};

function generateDropdownContent(itemName) {
  var columnsContainer = document.getElementById('dropdown-columns');
  columnsContainer.innerHTML = ''; 

  var data = menuData[itemName];
  if (!data) return;

  for (var i = 0; i < data.columns.length; i++) {
    var col = data.columns[i];
    var colDiv = document.createElement('div');
    colDiv.className = 'dropdown-column';

    if (col.heading) {
      var heading = document.createElement('h3');
      heading.className = 'dropdown-heading';
      heading.textContent = col.heading;
      colDiv.appendChild(heading);
    }

    var linksContainer = document.createElement('div');
    linksContainer.className = 'dropdown-links';

    for (var j = 0; j < col.links.length; j++) {
      var linkObj = col.links[j];
      var linkWrapper = document.createElement('div');
      linkWrapper.className = 'dropdown-link-item';
      var a = document.createElement('a');
      a.href = linkObj.url;
      a.textContent = linkObj.text;
      linkWrapper.appendChild(a);
      linksContainer.appendChild(linkWrapper);
    }

    colDiv.appendChild(linksContainer);
    columnsContainer.appendChild(colDiv);
  }
}

function showDropdown(itemName) {
  generateDropdownContent(itemName);
  document.getElementById('dropdown-menu').classList.add('active');
}

function hideDropdown() {
  document.getElementById('dropdown-menu').classList.remove('active');
}


var navLinks = document.querySelectorAll('.nav-menu a');
for (var k = 0; k < navLinks.length; k++) {
  (function(item) {
    var name = item.textContent.trim();
    item.addEventListener('mouseover', function() {
      if (window.innerWidth > 768) {
        showDropdown(name);
      }
    });
    item.addEventListener('mouseout', function() {
      if (window.innerWidth > 768) {
        setTimeout(function() {
          var dd = document.getElementById('dropdown-menu');
          if (!dd.matches(':hover')) {
            hideDropdown();
          }
        }, 200);
      }
    });
  })(navLinks[k]);
}


var dropdown = document.getElementById('dropdown-menu');
dropdown.addEventListener('mouseover', function() {
  dropdown.classList.add('active');
});
dropdown.addEventListener('mouseout', function() {
  if (window.innerWidth > 768) {
    hideDropdown();
  }
});


var hamburger = document.querySelector('.hamburger-menu');
hamburger.addEventListener('click', function(e) {
  if (window.innerWidth <= 768) {
    e.preventDefault();
    var dm = document.getElementById('dropdown-menu');
    if (dm.classList.contains('active')) {
      hideDropdown();
    } else {
      showDropdown('Storenav');
    }
  }
});


window.addEventListener('resize', function() {
  hideDropdown();
});


function showMenu(id) { 
  document.getElementById(id).classList.add('active'); 
}
function hideMenu(id) { 
  document.getElementById(id).classList.remove('active'); 
}

var searchIcon = document.querySelector('.nav-right img[alt="Search"]');
searchIcon.addEventListener('click', function(e) {
  e.preventDefault();
  var s = document.getElementById('search-menu');
  var c = document.getElementById('cart-menu');
  if (s.classList.contains('active')) {
    hideMenu('search-menu');
  } else {
    showMenu('search-menu');
    hideMenu('cart-menu');
  }
});

var cartIcon = document.querySelector('.nav-right img[alt="Cart"]');
cartIcon.addEventListener('click', function(e) {
  e.preventDefault();
  var c = document.getElementById('cart-menu');
  var s = document.getElementById('search-menu');
  if (c.classList.contains('active')) {
    hideMenu('cart-menu');
  } else {
    showMenu('cart-menu');
    hideMenu('search-menu');
  }
});


document.addEventListener('click', function(e) {
  if (!e.target.closest('.nav-right') &&
      !e.target.closest('#search-menu') &&
      !e.target.closest('#cart-menu')) {
    hideMenu('search-menu');
    hideMenu('cart-menu');
  }
});


var GNEWS_API_KEY = 'fb3f54678c419b66980249c9ed5365ad';
var GNEWS_ENDPOINT = 'https://gnews.io/api/v4/search?q=apple&lang=it&country=it&max=5&apikey=' + GNEWS_API_KEY;

function fetchNews() {
  var newsList = document.getElementById('news-list');
  fetch(GNEWS_ENDPOINT)
    .then(function(res) { return res.json(); })
    .then(function(data) {
      if (!data.articles) throw new Error('Nessun articolo ricevuto');
      newsList.innerHTML = '';
      for (var i = 0; i < data.articles.length; i++) {
        var art = data.articles[i];
        var item = document.createElement('div');
        item.className = 'news-item';
        var a = document.createElement('a');
        a.href = art.url;
        a.target = '_blank';
        a.textContent = art.title;
        var p = document.createElement('p');
        p.textContent = new Date(art.publishedAt).toLocaleDateString('it-IT');
        item.appendChild(a);
        item.appendChild(p);
        newsList.appendChild(item);
      }
    })
    .catch(function(err) {
      console.error('GNews error:', err);
      newsList.innerHTML = '<div class="error-item">Errore nel caricamento delle notizie.</div>';
    });
}

fetchNews();
setInterval(fetchNews, 300000); 



var WEATHERSTACK_KEY = '66802d94079fae855e4e4cc62e08086d'; 
var CITY = 'Catania';

function fetchWeather() {
  var container = document.getElementById('weather-widget');
  var url = 'https://api.weatherstack.com/current?access_key=' + WEATHERSTACK_KEY + '&query=' + encodeURIComponent(CITY) + '&units=m';

  fetch(url)
    .then(function(res) { return res.json(); })
    .then(function(data) {
      if (!data.current) throw new Error(data.error?.info || 'Errore sconosciuto');

      var iconUrl = data.current.weather_icons[0];
      var temperature = data.current.temperature;
      var desc = data.current.weather_descriptions[0];

      container.innerHTML = '\
        <img src="' + iconUrl + '" alt="Icona meteo">\
        <div class="weather-info">\
          <p class="temp">' + temperature + '¬∞C</p>\
          <p class="desc">' + desc + '</p>\
        </div>';
    })
    .catch(function(err) {
      console.error('Errore Weatherstack:', err);
      container.innerHTML = '<p class="weather-error">Errore nel caricamento del meteo.</p>';
    });
}

fetchWeather();
setInterval(fetchWeather, 600000); 











